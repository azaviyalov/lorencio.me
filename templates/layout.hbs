<!DOCTYPE html>
<!-- Generated from templates/layout.hbs via scripts/build.js. Do not edit this file directly. -->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{#if views.[0]}}{{views.[0].pageTitle}}{{/if}}</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
  {{#each views}}
  <div class="page" data-lang-view="{{lang}}" {{#unless isDefault}}hidden{{/unless}}>
    <header class="page__header">
      <nav class="language-selector" aria-label="Language selection">
        <button type="button" class="language-selector__button" data-lang="en" aria-label="Switch to English">EN</button>
        <button type="button" class="language-selector__button" data-lang="ru" aria-label="Switch to Russian">RU</button>
      </nav>
      <button type="button" class="page__export-pdf js-export-pdf" aria-label="Export to PDF">ðŸ’¾ PDF</button>
      <h1 class="page__name">{{name}}</h1>
      <p class="page__title">{{titleText}}</p>
      <p class="page__age">{{ageText}}</p>
    </header>
    
    <main class="page__content">
      <section class="section">
        <h2 class="section__heading">{{headings.education}}</h2>
        <ul class="education-list">{{> education education}}</ul>
      </section>
      
      <section class="section">
        <h2 class="section__heading">{{headings.experience}}</h2>
        <ul class="experience-list">{{> job jobs}}</ul>
      </section>
      
      <section class="section">
        <h2 class="section__heading">{{headings.petProjects}}</h2>
        <ul class="projects-list">{{> pet-project petProjects}}</ul>
      </section>
      
      <section class="section">
        <h2 class="section__heading">{{headings.contacts}}</h2>
        <ul class="contacts-list">{{> contact contacts}}</ul>
      </section>
    </main>
    
    <footer class="page__footer">
      <div class="page__footer-meta">Built at: {{../builtAt}}</div>
      <a href="https://github.com/azaviyalov/lorencio.me" target="_blank" rel="noopener noreferrer">Sources on GitHub</a>
    </footer>
  </div>
  {{/each}}

  <script>
    const buttons = document.querySelectorAll('[data-lang]');
    const views = document.querySelectorAll('[data-lang-view]');

    const setLang = (lang) => {
      views.forEach((view) => {
        const active = view.dataset.langView === lang;
        view.hidden = !active;
        if (active) document.title = view.querySelector('.page__name').textContent + ' - ' + view.querySelector('.page__title').textContent;
      });
      buttons.forEach((btn) =>
        btn.classList.toggle('language-selector__button--active', btn.dataset.lang === lang)
      );
      localStorage.setItem('lang', lang);
    };

    const storedLang = localStorage.getItem('lang');
    if (storedLang && Array.from(views).some((v) => v.dataset.langView === storedLang)) {
      setLang(storedLang);
    } else {
      setLang('en');
    }

    buttons.forEach((btn) =>
      btn.addEventListener('click', () => setLang(btn.dataset.lang))
    );

    function exportToPDF() {
      const element = Array.from(views).find((v) => !v.hidden);
      if (!element || typeof html2pdf === 'undefined') return;
      const clonedElement = element.cloneNode(true);
      clonedElement.style.border = 'none';
      clonedElement.style.boxShadow = 'none';
      const opt = {
        margin: 10,
        filename: `${element.querySelector('.page__name')?.textContent || 'resume'}.pdf`,
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2, useCORS: true, allowTaint: true },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };
      html2pdf().set(opt).from(clonedElement).save();
    }
    document.addEventListener('click', (e) => {
      if (e.target && e.target.classList.contains('js-export-pdf')) exportToPDF();
    });
  </script>
</body>
</html>
